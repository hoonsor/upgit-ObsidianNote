---
parent: 
sibling: 
child: 
aliases: 
tags: [å°ˆæ¡ˆç­†è¨˜ , å·¥ä½œ, é›»è…¦è»Ÿé«”]
status: ğŸŒ±
author: PAPAYAé›»è…¦æ•™å®¤
source: 
template-output: 002-Inbox
number headings: auto, first-level 1, max 6, contents ^toc, _.1.1.
created: Sunday, September 11th 2022, 10:53:13 am
modified: Tuesday, September 20th 2022, 9:57:13 pm
---
# 1110911-Excel å¿«é€Ÿåˆä½µå¯„é€éƒµä»¶ ^toc

- [[#1110911-Excel å¿«é€Ÿåˆä½µå¯„é€éƒµä»¶ ^toc|1110911-Excel å¿«é€Ÿåˆä½µå¯„é€éƒµä»¶]]
	- [[#1. å‰ç½®ä½œæ¥­|1. å‰ç½®ä½œæ¥­]]
		- [[#1.1. excel é–‹å•Ÿé–‹ç™¼äººå“¡é¸é …|1.1. excel é–‹å•Ÿé–‹ç™¼äººå“¡é¸é …]]
		- [[#1.2. excel VBA å¼•ç”¨ Outlook Library|1.2. excel VBA å¼•ç”¨ Outlook Library]]
	- [[#2. æ­¥é©Ÿ|2. æ­¥é©Ÿ]]
		- [[#2.1. å»ºç«‹ Outlook ç‰©ä»¶|2.1. å»ºç«‹ Outlook ç‰©ä»¶]]
		- [[#2.2. ä½¿ç”¨ç¯„æœ¬å»ºç«‹éƒµä»¶ç‰©ä»¶|2.2. ä½¿ç”¨ç¯„æœ¬å»ºç«‹éƒµä»¶ç‰©ä»¶]]
		- [[#2.3. è¨­å®šéƒµä»¶å‹•ä½œ|2.3. è¨­å®šéƒµä»¶å‹•ä½œ]]
			- [[#2.3.1. è¼¸å…¥ä¸»æ—¨|2.3.1. è¼¸å…¥ä¸»æ—¨]]
			- [[#2.3.2. è¼¸å…¥æ”¶ä»¶è€…|2.3.2. è¼¸å…¥æ”¶ä»¶è€…]]
			- [[#2.3.3. æ’å…¥é™„ä»¶|2.3.3. æ’å…¥é™„ä»¶]]
			- [[#2.3.4. æ›¿æ›ä¿¡ä»¶å…§å®¹ç‚ºæ¬„ä½æ–‡å­—|2.3.4. æ›¿æ›ä¿¡ä»¶å…§å®¹ç‚ºæ¬„ä½æ–‡å­—]]
			- [[#2.3.5. å±•ç¤ºéƒµä»¶|2.3.5. å±•ç¤ºéƒµä»¶]]
			- [[#2.3.6. æ”¹ç”¨è¿´åœˆæ’°å¯«|2.3.6. æ”¹ç”¨è¿´åœˆæ’°å¯«]]
			- [[#2.3.7. è¨ˆç®—ç¸½åˆ—æ•¸|2.3.7. è¨ˆç®—ç¸½åˆ—æ•¸]]
	- [[#3. æˆæœ|3. æˆæœ]]


## 1. å‰ç½®ä½œæ¥­
### 1.1. excel é–‹å•Ÿé–‹ç™¼äººå“¡é¸é …
æª”æ¡ˆâ†’é¸é …â†’è‡ªè¨‚åŠŸèƒ½å€â†’å³é‚Šéƒ¨åˆ†å°‡ã€Œé–‹ç™¼äººå“¡ã€æ ¸å–æ–¹å¡Šå‹¾é¸
![01|700](https://raw.githubusercontent.com/hoonsor/upgit-Obsidian/main/2022/09/11/upgit_20220911_1662868575.png)

### 1.2. excel VBA å¼•ç”¨ Outlook Library 
- (ä¸Šæ–¹é¸å–®) å·¥å…·â†’è¨­å®šå¼•ç”¨é …ç›®â†’å‹¾é¸ Microsoft Outlook 16.0 Object Library 
- æ­¤å‹•ä½œæ˜¯ç‚ºäº†è®“ excel VBA å¯ä»¥è·Ÿ Outlook æºé€šï¼Œå¯ä»¥ä½¿ç”¨ç›¸é—œçš„å‡½å¼

## 2. æ­¥é©Ÿ
### 2.1. å»ºç«‹ Outlook ç‰©ä»¶
Dim å°ä¿¡å·® As Outlook.Application
Set å°ä¿¡å·® = New Outlook.Application
### 2.2. ä½¿ç”¨ç¯„æœ¬å»ºç«‹éƒµä»¶ç‰©ä»¶
Dim æ–°éƒµä»¶ As MailItem
Set æ–°éƒµä»¶ = å°ä¿¡å·®.CreateItemFromTemplate(ç¯„æœ¬è·¯å¾‘)
### 2.3. è¨­å®šéƒµä»¶å‹•ä½œ
#### 2.3.1. è¼¸å…¥ä¸»æ—¨
æ–°éƒµä»¶.Subject = ä¸»æ—¨
#### 2.3.2. è¼¸å…¥æ”¶ä»¶è€…
æ–°éƒµä»¶.To = Cells(åˆ—æ•¸, 2).Value
#### 2.3.3. æ’å…¥é™„ä»¶
æ–°éƒµä»¶.Attachments.Add Cells(åˆ—æ•¸, 5).Value
#### 2.3.4. æ›¿æ›ä¿¡ä»¶å…§å®¹ç‚ºæ¬„ä½æ–‡å­—
æ–°éƒµä»¶.HTMLBody = Replace(æ–°éƒµä»¶.HTMLBody, æ¬„ä½ 1, Cells(åˆ—æ•¸, 1).Value)
æ–°éƒµä»¶.HTMLBody = Replace(æ–°éƒµä»¶.HTMLBody, æ¬„ä½ 2, Cells(åˆ—æ•¸, 3).Value)
æ–°éƒµä»¶.HTMLBody = Replace(æ–°éƒµä»¶.HTMLBody, æ¬„ä½ 3, Cells(åˆ—æ•¸, 4).Value)
#### 2.3.5. å±•ç¤ºéƒµä»¶
æ–°éƒµä»¶.Display
#### 2.3.6. æ”¹ç”¨è¿´åœˆæ’°å¯«
For åˆ—æ•¸ = 2 To ç¸½åˆ—æ•¸
Set æ–°éƒµä»¶ = å°ä¿¡å·®.CreateItemFromTemplate(ç¯„æœ¬è·¯å¾‘)
    With æ–°éƒµä»¶
        .To = Cells(åˆ—æ•¸, 2).Value
        .Subject = ä¸»æ—¨
        .Attachments.Add Cells(åˆ—æ•¸, 5).Value
        .HTMLBody = Replace(.HTMLBody, æ¬„ä½ 1, Cells(åˆ—æ•¸, 1).Value)
        .HTMLBody = Replace(.HTMLBody, æ¬„ä½ 2, Cells(åˆ—æ•¸, 3).Value)
        .HTMLBody = Replace(.HTMLBody, æ¬„ä½ 3, Cells(åˆ—æ•¸, 4).Value)
        .Send
    End With
Next åˆ—æ•¸
#### 2.3.7. è¨ˆç®—ç¸½åˆ—æ•¸
ç¸½åˆ—æ•¸ = Cells(1000, 1).End(xlUp).Row
## 3. æˆæœ
```VBA
Sub å¯„é€éƒµä»¶()

Dim å°ä¿¡å·® As Outlook.Application
Set å°ä¿¡å·® = New Outlook.Application
Dim æ–°éƒµä»¶ As MailItem
Dim åˆ—æ•¸, ç¸½åˆ—æ•¸ As Integer
Dim ç¯„æœ¬è·¯å¾‘, æ¬„ä½1, æ¬„ä½2, æ¬„ä½3, ä¸»æ—¨ As String

ç¯„æœ¬è·¯å¾‘ = "C:\Users\hoonsor\AppData\Roaming\Microsoft\Templates\1110911-ç¯„æœ¬.oft"
æ¬„ä½1 = "ã€Œæ•™å¸«åå–®ã€"
æ¬„ä½2 = "ã€Œèª²ç¨‹åç¨±ã€"
æ¬„ä½3 = "ã€Œæ™‚æ®µã€"
ä¸»æ—¨ = "èª²ç¨‹å ±åæˆåŠŸï¼"

ç¸½åˆ—æ•¸ = Cells(1000, 1).End(xlUp).Row

For åˆ—æ•¸ = 2 To ç¸½åˆ—æ•¸
Set æ–°éƒµä»¶ = å°ä¿¡å·®.CreateItemFromTemplate(ç¯„æœ¬è·¯å¾‘)
    With æ–°éƒµä»¶
        .To = Cells(åˆ—æ•¸, 2).Value
        .Subject = ä¸»æ—¨
        .Attachments.Add Cells(åˆ—æ•¸, 5).Value
        .HTMLBody = Replace(.HTMLBody, æ¬„ä½1, Cells(åˆ—æ•¸, 1).Value)
        .HTMLBody = Replace(.HTMLBody, æ¬„ä½2, Cells(åˆ—æ•¸, 3).Value)
        .HTMLBody = Replace(.HTMLBody, æ¬„ä½3, Cells(åˆ—æ•¸, 4).Value)
        .Send
    End With
Next åˆ—æ•¸

End Sub
```