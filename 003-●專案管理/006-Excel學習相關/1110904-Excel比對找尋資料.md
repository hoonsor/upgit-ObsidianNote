---
parent: 
sibling: 
child: 
aliases: 
tags: [專案筆記 , 電腦軟體, 工作]
status: 🌱
author: 
source: https://www.youtube.com/watch?v=aO_B2xj_rhc&t=211s
template-output: 002-Inbox
number headings: auto, first-level 1, max 6, contents ^toc, _.1.1.
obsidianUIMode: preview 
created: Sunday, September 4th 2022, 9:44:03 am
modified: Sunday, September 4th 2022, 10:53:49 pm
---
# 1110904-Excel 比對找尋資料

## 1. 概論

> ExcelTips:: 舊版 Excel 引數使用陣列輸入的話需要按 Ctrl+Shift+Enter，不然公式會無法正確顯示

### 1.1. 陣列比較

> ExcelTips:: 可以使用一個陣列跟一個數值去比較，實際上會是該陣列的每一個元素在對應的儲存格會跟該數值去做比較，範例：\$B\$3:\$B\$14=\$F\$2，儲存格範圍為 B3:B14，每一個儲存格都與 F2 做比較，並回傳 True 或 False

### 1.2. 數值運算後回傳陣列
> ExcelTips:: 想要在使用函數運算後回傳的元素組合成陣列，裡面的 reference 輸入均需要是陣列，範例：=SMALL(IF(\$B\$3:\$B\$14=\$F\$2,ROW(\$B\$3:\$B\$14)-2),ROW(1:1))，SMALL 的第一個引數需要是陣列，而 IF(\$B\$3:\$B\$14=\$F\$2,ROW(\$B\$3:\$B\$14)-2) 就是一個使用 IF、ROW 函數輸入後回傳之元素組合而成之陣列，但記得最後使用時需要按 Ctrl+Shift+Enter，公式左右並會顯示大括弧，這樣才能得到正確之結果
> 
## 2. 函數介紹

### 2.1. ROW
回傳 Reference 儲存格的列號

### 2.2. INDEX
引數輸入儲存格陣列（一維、二維）及數字（Row 或 Colmn 位置對應數字，數字代表之位置為往下往右遞增），會顯示出該數字對應的陣列元素名稱

### 2.3. SMALL
引數輸入儲存格陣列及數字（陣列數值大小序位），會顯示出該陣列中第 N 小的數值，輸入 1 就是最小的數值、輸入 2 就是第 2 小的數值

## 3. 心得
### 3.1. 步驟
#### 3.1.1. 比對鍵值相同之列
先將所欲查詢之 key 使用等於運算子與原需要比對之陣列比較，並且列出 Boolean 陣列
#### 3.1.2. 轉換為陣列元素位置
將 Boolean 數值搭配 IF、ROW 轉換成陣列元素位置數值
#### 3.1.3. 排序元素位置
使用 SMALL 函數讓數值從小到大排序
#### 3.1.4. 位置還原為元素
使用 INDEX 函數將陣列元素位置數值轉換回原本的陣列元素

## 4. 練習範例檔
![[Excel 51.xlsx]]